<div style="max-width:800px;margin:1rem auto;padding:1rem;border:1px solid #ddd;border-radius:6px; font-family: sans-serif;">
  <h3>Monthly Report</h3>

  <div style="margin-bottom:1rem; display: flex; gap: 15px; align-items: flex-end;">
    <label style="display: flex; flex-direction: column;">
      <span style="font-size: 0.8rem; color: #666;">Year</span>
      <input type="number" min="2000" [(ngModel)]="year" [placeholder]="currentYear" style="padding: 4px; border: 1px solid #ccc; border-radius: 4px;" />
    </label>

    <label style="display: flex; flex-direction: column;">
      <span style="font-size: 0.8rem; color: #666;">Month</span>
      <input type="number" min="1" max="12" [(ngModel)]="month" [placeholder]="currentMonth" style="padding: 4px; border: 1px solid #ccc; border-radius: 4px;" />
    </label>

    <button (click)="loadReport()" style="padding: 6px 16px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px;">
      {{ status === 'Loading...' ? 'Processing...' : 'Generate Report' }}
    </button>
  </div>

  <div style="margin-bottom:1rem;">
    <span style="font-size: 0.9rem; color:#666">Status: <strong>{{ status }}</strong></span>
  </div>

  <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;" />

  <div *ngIf="report">
    <h4>Summary</h4>
    <table style="width:100%;border-collapse:collapse;">
      <tbody>
      <tr><th style="text-align:left;padding:8px;border:1px solid #ddd;background:#333;color:white">Period</th><td style="padding:8px;border:1px solid #ddd;background:#333;color:white">{{ report.year }} / {{ report.month }}</td></tr>
      <tr><th style="text-align:left;padding:8px;border:1px solid #ddd;background:#333;color:white">Available Vehicles</th><td style="padding:8px;border:1px solid #ddd;background:#333;color:white">{{ report.availableVehicles }}</td></tr>
      <tr><th style="text-align:left;padding:8px;border:1px solid #ddd;background:#333;color:white">Total Service Cost</th><td style="padding:8px;border:1px solid #ddd;background:#333;color:white; font-weight: bold;">{{ toNumber(report.totalServiceCost) | number:'1.2-2' }}</td></tr>
      </tbody>
    </table>
    
    <div *ngFor="let cfg of listsConfig" style="margin-top:20px;">
      <ng-container *ngIf="report[cfg.key]?.length; else noneTpl">
        <h4 style="margin-bottom: 8px; color: #333;">{{ cfg.title }}</h4>
        <table style="width:100%;border-collapse:collapse">
          <thead>
          <tr style="background: #333;color:white;">
            <th style="padding:8px;border:1px solid #ddd;background:#333;color:white;text-align:left">Item</th>
            <th style="padding:8px;border:1px solid #ddd;background:#333;color:white;text-align:left">Count</th>
            <th style="padding:8px;border:1px solid #ddd;background:#333;color:white;text-align:left">Value</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let item of report[cfg.key];let even=even" style="background:{{even?'#f9f9f9':'#fff'}}">
            <td style="padding:8px;border:1px solid #ddd;background:#333;color:white">{{ item.key || 'N/A' }}</td>
            <td style="padding:8px;border:1px solid #ddd;background:#333;color:white">{{ item.count || 0 }}</td>
            <td style="padding:8px;border:1px solid #ddd;background:#333;color:white">{{ toNumber(item.value) | number:'1.2-2' }}</td>
          </tr>
          </tbody>
        </table>
      </ng-container>
      <ng-template #noneTpl>
        <h4 style="color: #999;">{{ cfg.title }} (No data found)</h4>
      </ng-template>
    </div>
  </div>

  <div *ngIf="error" style="background: #fff5f5; border: 1px solid #feb2b2; padding: 10px; border-radius: 4px; margin-top: 12px;">
    <p style="color: #c53030; margin: 0; font-weight: bold;">Error Details:</p>
    <pre style="white-space:pre-wrap; color: #c53030; font-size: 0.85rem; margin-top: 5px;">{{ error }}</pre>
  </div>
</div>
